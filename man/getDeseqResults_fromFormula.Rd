% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/getDeseqResults_fromFormula.R
\name{getDeseqResults_fromFormula}
\alias{getDeseqResults_fromFormula}
\title{Differential Expression Analysis from Phyloseq Object Using Formula}
\usage{
getDeseqResults_fromFormula(phobj, opt, name = "", formula = "~ Condition")
}
\arguments{
\item{phobj}{A phyloseq object containing count data and sample metadata.}

\item{opt}{A list of options controlling filtering and output parameters. Expected fields include \code{mincount}, \code{minsampleswithcount}, \code{minfreq}, and \code{out} (output directory).}

\item{name}{A string appended to output filenames (default is empty).}

\item{formula}{A design formula for DESeq2 (default is \code{"~ Condition"}).}
}
\value{
A list containing DESeq2 results, raw and normalized counts, contrasts, and additional diagnostic data.
}
\description{
Performs DESeq2 differential expression analysis on a phyloseq object using a specified design formula.
Filters features based on minimum counts and samples, supports multiple contrasts, and returns results including normalized and transformed counts.
}
\details{
The function:
\itemize{
\item Extracts variables from the design formula,
\item Filters OTUs based on count thresholds,
\item Runs DESeq2 with or without a pseudocount depending on data,
\item Performs contrasts for all pairwise comparisons of categorical variables or numerical covariates,
\item Saves intermediate results as TSV files and an RData file.
}
}
\examples{
\dontrun{
if(interactive()){
  # Assuming 'ps' is a phyloseq object and opt is a list with options
  opt <- list(mincount=10, minsampleswithcount=3, minfreq=0.01, out="./results/")
  results <- getDeseqResults_fromFormula(ps, opt, name="MyAnalysis", formula="~ Condition + Age")
}
}
}
\seealso{
\code{\link[phyloseq]{phyloseq_to_deseq2}}, \code{\link[DESeq2]{DESeq}}, \code{\link[DESeq2]{results}}, \code{\link[DESeq2]{varianceStabilizingTransformation}}
}
