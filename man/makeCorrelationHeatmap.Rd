% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/makeCorrelationHeatmap.R
\name{makeCorrelationHeatmap}
\alias{makeCorrelationHeatmap}
\title{Generate Correlation Heatmap Between Two Matrices}
\usage{
makeCorrelationHeatmap(
  mat1,
  mat2,
  cormethod = "pearson",
  pval = 0.05,
  select_asvs = c(),
  outdir = "./",
  name = "corrHeatmap",
  clust = T,
  order_rows = c(),
  order_cols = c()
)
}
\arguments{
\item{mat1}{Numeric matrix or data frame. Columns represent variables/features (e.g., ASVs, taxa) for correlation.}

\item{mat2}{Numeric matrix or data frame. Columns represent variables/features to correlate with those in \code{mat1}.}

\item{cormethod}{Correlation method to use. One of "pearson" (default), "spearman", or "kendall".}

\item{pval}{Numeric threshold for significance (default 0.05). Only rows (variables in \code{mat1}) with at least one correlation p-value below this threshold are included, unless \code{select_asvs} is provided.}

\item{select_asvs}{Character vector of row names (variables in \code{mat1}) to explicitly include in the heatmap. Overrides \code{pval} filtering.}

\item{outdir}{Output directory path where the heatmap PDF will be saved. Default is current directory ("./").}

\item{name}{Filename prefix for output PDF (default: "corrHeatmap").}

\item{clust}{Logical indicating whether to cluster rows and columns (default TRUE).}

\item{order_rows}{Character vector specifying the order of rows if clustering is disabled (default empty).}

\item{order_cols}{Character vector specifying the order of columns if clustering is disabled (default empty).}
}
\value{
A list containing:
\item{hm}{The pheatmap object (invisible) generated by the function.}
\item{asvs}{The vector of selected ASVs (rows) included in the heatmap.}
\item{cormat}{The correlation matrix subsetted and possibly reordered for plotting.}
\item{pvals}{Matrix of p-values corresponding to the correlations.}
\item{cor_ptext}{Matrix of significance symbols corresponding to p-values.}
}
\description{
Computes pairwise correlations between columns of two matrices and plots a heatmap annotated with significance levels.
}
\details{
The function computes correlation coefficients and p-values between every pair of columns from \code{mat1} and \code{mat2}.
It filters variables from \code{mat1} based on significance thresholds or a user-provided selection.
The resulting heatmap includes correlation values annotated with significance stars, enhancing interpretability.
}
\examples{
\dontrun{
if(interactive()){
  mat1 <- matrix(rnorm(100*10), nrow=100, ncol=10)
  colnames(mat1) <- paste0("VarA", 1:10)
  mat2 <- matrix(rnorm(100*8), nrow=100, ncol=8)
  colnames(mat2) <- paste0("VarB", 1:8)
  result <- makeCorrelationHeatmap(mat1, mat2, cormethod="spearman", pval=0.05)
}
}
}
\seealso{
\code{\link[tidyr]{spread}}, \code{\link[pheatmap]{pheatmap}}
}
