% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compareLFCContrats3.R
\name{compareLFCContrats3}
\alias{compareLFCContrats3}
\title{Compare Log Fold Changes Across Multiple Contrasts}
\usage{
compareLFCContrats3(
  contrastlist,
  firstContrast,
  contrastNamesOrdered,
  mainContrastName,
  plim_select = 1e-06,
  plim_plot = 0.05,
  name2remove = "",
  resdfname = "resdf",
  outdir = "./",
  name = "LFC_compare3",
  w = 8,
  h = 4,
  scale_mode = "fixed"
)
}
\arguments{
\item{contrastlist}{A named list where each element contains a results data frame (e.g., "resdf") from a DESeq2 contrast, with columns \code{taxon}, \code{log2FoldChangeShrink}, and \code{padj}.}

\item{firstContrast}{A single contrast results object (list containing a \code{resdf}) used as the reference for ordering taxa.}

\item{contrastNamesOrdered}{Character vector giving the order of contrasts in the plot facets.}

\item{mainContrastName}{Name to assign to the \code{firstContrast} when plotting.}

\item{plim_select}{Adjusted p-value threshold for selecting taxa to display (taxa must have adjusted p-value < threshold in all contrasts). Default: \code{1e-6}.}

\item{plim_plot}{Adjusted p-value threshold for significance coloring in the plot. Default: \code{0.05}.}

\item{name2remove}{Pattern to remove from contrast names before plotting. Default: \code{""}.}

\item{resdfname}{Name of the data frame within each list element that contains the results. Default: \code{"resdf"}.}

\item{outdir}{Directory where the PDF will be saved. Default: \code{"./"}.}

\item{name}{Filename prefix for the saved plot. Default: \code{"LFC_compare3"}.}

\item{w}{Width of the saved PDF in inches. Default: \code{8}.}

\item{h}{Height of the saved PDF in inches. Default: \code{4}.}

\item{scale_mode}{Facet scale mode for ggplot: \code{"fixed"} or \code{"free"}. Default: \code{"fixed"}.}
}
\value{
A \code{ggplot} object with the barplot comparison of log2 fold changes.
}
\description{
Combines and visualizes shrunken log2 fold changes from multiple contrasts,
filtering taxa by adjusted p-value (in all contrasts) and ordering them based on a main contrast.
}
\details{
The function merges results from all contrasts, selects taxa with adjusted p-values below the threshold in all contrasts,
orders taxa by the main contrast, and creates a horizontal barplot with facets for each contrast.
Significance is indicated by color. Underscores in taxon and contrast names are replaced with spaces for readability.
}
\examples{
\dontrun{
if(interactive()){
  g <- compareLFCContrats3(contrastlist, firstContrast,
                           contrastNamesOrdered = c("Contrast1", "Contrast2"),
                           mainContrastName = "Main")
  print(g)
}
}
}
\seealso{
\code{\link[dplyr]{filter}}, \code{\link[dplyr]{mutate}}, \code{\link[tidyr]{spread}}
}
