% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_ensemble_probs.R
\name{make_ensemble_probs}
\alias{make_ensemble_probs}
\title{Combine Probabilistic Predictions from Multiple Models Using Cross-Validated Performance}
\usage{
make_ensemble_probs(
  datasc,
  levs,
  modlist,
  model_res,
  param = "BalancedAccuracy_l1out",
  min_val = 0,
  prop = TRUE,
  only_1_knn = FALSE
)
}
\arguments{
\item{datasc}{A data frame containing the samples used for prediction. Must include the actual class labels in a column named \code{class}.}

\item{levs}{A character vector of class levels (e.g., \code{c("control", "case")}).}

\item{modlist}{A named list of trained models, where each element is a list containing \code{$pred_probs}, a numeric vector
of predicted probabilities (typically from cross-validation).}

\item{model_res}{A data frame with model performance metrics from cross-validation. Must include a column named \code{model} and
a metric column used in \code{param}.}

\item{param}{A string with the name of the performance metric column in \code{model_res} to be used as
weight (e.g., 'BalancedAccuracy_l1out'). Default: \code{"BalancedAccuracy_l1out"}}

\item{min_val}{Minimum value of the chosen performance metric for a model to be included in the ensemble. Default: \code{0}}

\item{prop}{Logical; whether to weight predictions proportionally to the model's performance. Default: \code{TRUE}}

\item{only_1_knn}{Logical; if \code{TRUE}, only the best KNN model is used in the ensemble. Default: \code{FALSE}}
}
\value{
A list with elements:
\itemize{
\item \code{confmat}: Confusion matrix comparing predicted vs actual classes.
\item \code{confmat_no_l1o}: Placeholder for compatibility (NULL).
\item \code{mod}: Placeholder for compatibility (NULL).
\item \code{preds}: Factor vector of predicted class labels.
\item \code{pred_probs}: Numeric vector of averaged predicted probabilities.
\item \code{pred_df}: Data frame of individual model probabilities.
\item \code{preds_no_l1o}: Placeholder for compatibility (NULL).
\item \code{roc_obj_no_l1o}: Placeholder for compatibility (NULL).
\item \code{roc_auc_no_l1o}: Placeholder for compatibility (NULL).
\item \code{roc_obj}: ROC object computed from ensemble probabilities.
\item \code{roc_auc}: AUC value of the ensemble prediction.
}
}
\description{
This function combines probabilistic outputs from several classification models into
a single prediction using weighted averaging. Model performance is used as a weight, and predictions
are evaluated using cross-validation results.
}
\details{
Models are selected based on their cross-validation performance (e.g., Balanced Accuracy),
and probabilistic predictions are combined using a weighted average. If \code{prop = TRUE},
weights are scaled to a 0â€“1 range and slightly regularized (+0.1).

The ensemble is evaluated using the ROC AUC and confusion matrix, assuming binary classification.

Note: This function assumes that \code{pred_probs} are numeric probabilities between 0 and 1, and class labels are binary and ordered.
}
\examples{
\dontrun{
if(interactive()){
 #EXAMPLE1
 }
}
}
\seealso{
\code{\link[dplyr]{arrange}}, \code{\link[dplyr]{filter}}
}
