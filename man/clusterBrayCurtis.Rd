% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clusterBrayCurtis.R
\name{clusterBrayCurtis}
\alias{clusterBrayCurtis}
\title{Hierarchical Clustering of Samples Using Bray-Curtis Distance}
\usage{
clusterBrayCurtis(
  phobj,
  variable = "Condition",
  renamestr = "",
  dist_type = "bray",
  clust_method = "ward.D2"
)
}
\arguments{
\item{phobj}{A \code{phyloseq} object containing microbiome data.}

\item{variable}{Character string specifying the sample metadata variable to use for coloring the dendrogram and labeling the heatmap. Default: 'Condition'}

\item{renamestr}{Character string to replace prefix "X" in sample names after transpose (if needed). Default: ''}

\item{dist_type}{Distance metric to compute sample distances. Default: 'bray'}

\item{clust_method}{Clustering method to use for hierarchical clustering. Default: 'ward.D2'}
}
\value{
A list containing:
\item{ward}{A dendrogram object of the hierarchical clustering}
\item{hmplot}{A \code{ggplot} heatmap plot object generated by \code{phyloseq::plot_heatmap}}
}
\description{
Performs hierarchical clustering of samples in a phyloseq object using Bray-Curtis distance (or another specified distance) on relative abundances, and plots a heatmap faceted by a sample metadata variable.
}
\details{
The function first transforms the OTU counts to relative abundances,
computes a sample distance matrix using the specified distance method,
performs hierarchical clustering, colors dendrogram labels by the grouping variable,
and finally produces a heatmap faceted by the grouping variable.
}
\examples{
\dontrun{
if(interactive()){
  library(phyloseq)
  data(GlobalPatterns)

  # Perform clustering faceted by SampleType
  res <- clusterBrayCurtis(
    phobj = GlobalPatterns,
    variable = "SampleType",
    renamestr = "",
    dist_type = "bray",
    clust_method = "ward.D2"
  )

  # Plot dendrogram
  plot(res$ward)

  # Print heatmap
  print(res$hmplot)
}
}
}
\seealso{
\code{\link[phyloseq]{transform_sample_counts}}, \code{\link[phyloseq]{otu_table}}, \code{\link[phyloseq]{distance}}, \code{\link[phyloseq]{sample_data}}, \code{\link[phyloseq]{plot_heatmap}}
}
