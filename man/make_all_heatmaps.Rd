% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_all_heatmaps.R
\name{make_all_heatmaps}
\alias{make_all_heatmaps}
\title{Generate Heatmaps for All Differential Abundance Results}
\usage{
make_all_heatmaps(
  dearesults,
  df2plot,
  metadata,
  vars2heatmap,
  dds,
  opt,
  max_hm_h = 16,
  max_hm_w = 7
)
}
\arguments{
\item{dearesults}{A list of differential abundance result objects. Each object
is expected to contain at least:
\itemize{
\item \code{resdf}: a data frame with columns \code{taxon}, \code{pvalue}, and \code{padj}.
\item \code{contrast_vec}: a vector specifying the contrast used (first element is the variable name, next two are levels to compare).
\item \code{nested_dir}: output directory path for saving heatmaps.
\item \code{name}: identifier for the comparison.
}}

\item{df2plot}{A data frame with abundance or expression data to plot,
where the first column is \code{gene} and subsequent columns are sample IDs.}

\item{metadata}{A data frame with sample metadata, including the variable
used for contrasts and a column \code{sampleID} to match \code{df2plot}.}

\item{vars2heatmap}{A vector of variable names (metadata columns) to annotate
in the heatmap.}

\item{dds}{A \code{DESeqDataSet} or similar object containing the full dataset,
used by \code{makeHeatmap} to retrieve normalized data.}

\item{opt}{A list of options, where \code{opt$pval} is the p-value threshold
for selecting features to plot.}

\item{max_hm_h}{Maximum height of the heatmap (in inches). Default: \code{16}.}

\item{max_hm_w}{Max heatmap width. If 0, will be automatically determined depending on number of cols. Default: \code{7}.}
}
\value{
Invisibly returns \code{NULL}. Heatmap PDF files are saved to the paths
specified by \code{nested_dir} and \code{name} for each result.
}
\description{
Iterates over a list of differential abundance results and generates
heatmaps for features (taxa/genes) that are significant according to
raw p-value and adjusted p-value thresholds. Two heatmaps are generated
per result: one using raw p-values and another using adjusted p-values.
}
\details{
For each element in \code{dearesults}, this function:
\enumerate{
\item Selects features (taxa/genes) with \code{pvalue < opt$pval} and \code{padj < opt$pval}.
\item Filters \code{metadata} to include only the samples in the current contrast.
\item Subsets \code{df2plot} to those samples.
\item Calls \code{makeHeatmap()} twice â€” once for raw p-values, once for adjusted p-values.
}
Errors in heatmap generation are caught and reported without stopping the loop.
Open graphics devices are closed after each iteration.
}
\examples{
\dontrun{
if(interactive()){
  make_all_heatmaps(
    dearesults = my_dea_list,
    df2plot = abundance_table,
    metadata = sample_metadata,
    vars2heatmap = c("Condition", "Sex"),
    dds = my_dds,
    opt = list(pval = 0.05)
  )
}
}
}
\seealso{
\code{\link[dplyr]{filter}}
}
