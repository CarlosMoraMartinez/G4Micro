% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/makeHeatmap.R
\name{makeHeatmap}
\alias{makeHeatmap}
\title{Generate Heatmap of Selected Taxa or Genes from Differential Expression Results}
\usage{
makeHeatmap(
  resdf,
  dds,
  df2plot,
  variable = "condition",
  opt,
  name = "heatmap.pdf",
  logscale = FALSE,
  ptype = "padj",
  w = 5,
  h = 4,
  trim_values = FALSE,
  italics_rownames = TRUE,
  taxalist = c(),
  check_taxa = TRUE,
  max_hm_h = 16,
  max_hm_w = 7,
  annotcols_num = c("blue", "white", "red"),
  annotpal_cat = "Darjeeling1"
)
}
\arguments{
\item{resdf}{A data frame containing differential expression results, including
p-values, adjusted p-values, log2 fold changes, and taxa or gene identifiers.}

\item{dds}{A \code{DESeqDataSet} object containing expression data and sample metadata.}

\item{df2plot}{A data frame or matrix of expression values with genes/taxa as rows
and samples as columns. Must include a column named "gene" for filtering.}

\item{variable}{Character. The name of the sample metadata column to use for annotation
(default is \code{"condition"}).}

\item{opt}{A list or object containing analysis options, including:
\itemize{
\item \code{pval}: numeric, significance threshold for p-value or adjusted p-value.
\item \code{fc}: numeric, fold-change cutoff.
\item \code{out}: character, output directory to save the heatmap PDF.
}}

\item{name}{Character. Filename for the output PDF heatmap (default \code{"heatmap.pdf"}).}

\item{logscale}{Logical. Whether to log-transform the expression values before plotting (default \code{FALSE}).}

\item{ptype}{Character. Type of p-value to filter by: \code{"padj"} for adjusted p-values or \code{"pvalue"} (default \code{"padj"}).}

\item{w}{Numeric. Width of the output PDF in inches (default 5).}

\item{h}{Numeric. Height of the output PDF in inches (default 4).}

\item{trim_values}{Logical. Whether to trim expression values at the 1st and 99th percentiles to reduce outliers (default \code{FALSE}).}

\item{italics_rownames}{Logical. Whether to italicize the row labels (default \code{TRUE}).}

\item{taxalist}{Character vector. A custom list of taxa or genes to include; if empty, selection is based on significance criteria (default empty vector).}

\item{check_taxa}{Check whether all taxa in \code{taxalist} exist or not.}

\item{max_hm_h}{Heatmap height. If 0, will be automatically determined depending on number of rows.}

\item{max_hm_w}{Max heatmap width. If 0, will be automatically determined depending on number of cols}

\item{annotcols_num}{Max heatmap height}

\item{annotpal_cat}{Name of Wes Anderson palette to annotate categorical variables. Default = \code{c("blue", "white", "red")}}
}
\value{
None. The function saves a PDF heatmap file to the specified output directory. Default = "Darjeeling1"
}
\description{
Creates and saves a heatmap of expression values for selected taxa or genes based on
significance criteria from differential expression analysis results. The heatmap
includes sample annotations and offers options for log-scaling, trimming extreme values,
and italicizing row names.
}
\details{
The function filters taxa/genes based on p-value or adjusted p-value thresholds and
fold-change cutoffs. If the number of selected taxa is fewer than a default number
(from \code{opt$num_genes_default}), it selects the top taxa by p-value.
Expression values are optionally log-transformed and scaled per gene before plotting.
The heatmap is generated with sample annotations for the specified metadata variable.
Row labels can be italicized for better visualization of taxon names.
}
\examples{
\dontrun{
if(interactive()){
  opt <- list(pval = 0.05, fc = 2, out = "results", num_genes_default = 50)
  makeHeatmap(resdf, dds, expression_df,
              variable = "condition", opt = opt,
              name = "diff_heatmap.pdf", logscale = TRUE)
}
}

}
\seealso{
\code{\link[dplyr]{filter}}, \code{\link[pheatmap]{pheatmap}}
}
