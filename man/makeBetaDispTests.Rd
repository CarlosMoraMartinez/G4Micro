% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/makeBetaDispTests.R
\name{makeBetaDispTests}
\alias{makeBetaDispTests}
\title{Perform Beta Dispersion Tests Across Sample Metadata Variables}
\usage{
makeBetaDispTests(
  phobj,
  dist_method = "bray",
  exclude_vars = c("sampleID"),
  outname
)
}
\arguments{
\item{phobj}{A \code{phyloseq} object containing microbiome data and sample metadata.}

\item{dist_method}{Distance metric to calculate beta diversity (passed to \code{\link[phyloseq]{distance}}). Default: "bray".}

\item{exclude_vars}{Character vector of sample metadata variable names to exclude from testing (e.g., sample IDs). Default: \code{c("sampleID")}.}

\item{outname}{File path to save the output results as a TSV file.}
}
\value{
A data.frame summarizing the beta dispersion test results, with columns for the variable name, F statistic, and p-value.
}
\description{
Computes beta diversity distance matrix for a phyloseq object, then tests for differences in dispersion (variance) across levels of each metadata variable, excluding specified variables.
}
\details{
For each sample metadata variable (except those excluded), this function calculates the beta dispersion
(variance of distances to group centroids) using \code{\link[vegan]{betadisper}} on the distance matrix
generated by \code{\link[phyloseq]{distance}}. Significance is assessed by permutation tests
using \code{\link[vegan]{permutest}}. Results are saved to a TSV file and returned as a data.frame.
}
\examples{
\dontrun{
if(interactive()){
  library(phyloseq)
  library(vegan)
  data(GlobalPatterns)
  res <- makeBetaDispTests(GlobalPatterns, dist_method = "bray",
                          exclude_vars = c("sampleID"),
                          outname = "beta_dispersion_results.tsv")
  print(res)
}
}
}
\seealso{
\code{\link[phyloseq]{distance}}, \code{\link[vegan]{betadisper}}, \code{\link[vegan]{permutest}}
}
