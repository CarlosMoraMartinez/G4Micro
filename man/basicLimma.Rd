% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/basicLimma.R
\name{basicLimma}
\alias{basicLimma}
\title{@title Differential Expression Analysis Using Limma-Voom with Duplicate Correlation}
\usage{
basicLimma(
  phobj,
  opt,
  variables = c("Condition"),
  individual = "pacienteID",
  outdir = "",
  name = "basic_limma"
)
}
\arguments{
\item{phobj}{A phyloseq object containing OTU count data and sample metadata.}

\item{opt}{A list of options controlling filtering thresholds:
\itemize{
\item \code{mincount} Minimum count threshold for filtering OTUs.
\item \code{minsampleswithcount} Minimum number of samples that must pass the count threshold.
}}

\item{variables}{Character vector of covariate names to include in the design formula (default: \code{c("Condition")}).}

\item{individual}{Character string naming the individual/sample grouping variable to account for repeated measures (default: \code{"pacienteID"}).}

\item{outdir}{Character string specifying output directory path for saving results (default: \code{""}).}

\item{name}{Character string specifying the base name for output files (default: \code{"basic_limma"}).}
}
\value{
A list containing:
\itemize{
\item \code{result}: A data frame with the differential expression test results sorted by p-value.
\item \code{vobj}: The \code{voom}-transformed expression set after duplicateCorrelation adjustment.
\item \code{vobj_tmp}: Initial \code{voom} object before duplicateCorrelation adjustment.
\item \code{fitmm}: The linear model fit object after contrast and empirical Bayes steps.
\item \code{contrast}: The contrast matrix used for hypothesis testing.
}
}
\description{
Performs differential expression analysis on count data from a phyloseq object
using the limma-voom pipeline. This method models the mean-variance relationship of
RNA-seq or similar count data by applying voom transformation,
allowing the use of linear models for differential expression.

To account for repeated measures or batch effects from individuals, this function
estimates within-individual correlations using the \code{duplicateCorrelation} method.
This approach fits a linear mixed model by incorporating a consensus correlation
structure as a random effect, improving the accuracy of variance estimation and
statistical testing.

The model formula is constructed dynamically from specified covariates (e.g., experimental conditions).
Differential contrasts (e.g., "ConditionAfter - ConditionBefore") are specified and tested
with moderated t-statistics from empirical Bayes shrinkage.

The function writes results to disk as a tab-separated values file and saves the entire analysis
environment for downstream inspection or visualization.
}
\details{
This function implements the limma-voom pipeline tailored for count data with repeated measures.

Steps include:
\enumerate{
\item Filtering low-count OTUs based on \code{opt$mincount} and \code{opt$minsampleswithcount}.
\item Creating a design matrix from the specified variables.
\item Normalizing counts with TMM (Trimmed Mean of M-values) via \code{calcNormFactors}.
\item Applying the voom transformation to estimate the mean-variance trend and compute weights.
\item Estimating the correlation between repeated samples using \code{duplicateCorrelation}.
\item Re-running voom with the correlation and fitting a linear model with blocking for individuals.
\item Defining contrasts for comparison (here, "ConditionAfter - ConditionBefore").
\item Computing moderated t-statistics with empirical Bayes shrinkage.
}

Output files include a TSV file with DE results and an RData file with all key objects.
}
\examples{
\dontrun{
if(interactive()){

  # Load or prepare phyloseq object with count data and sample metadata
  phobj <- phyloseq::your_phyloseq_object

  # Define options for filtering
  opt <- list(mincount=5, minsampleswithcount=3)

  # Run basic Limma differential expression analysis
  res <- basicLimma(phobj, opt, variables = c("Condition"), individual = "SampleID", outdir = "results/", name = "DE_Analysis")
}
}
}
\seealso{
\code{\link[limma]{voom}},
\code{\link[limma]{duplicateCorrelation}},
\code{\link[limma]{lmFit}},
\code{\link[limma]{makeContrasts}},
\code{\link[limma]{contrasts.fit}},
\code{\link[limma]{eBayes}},
\code{\link[edgeR]{DGEList}},
\code{\link[edgeR]{calcNormFactors}},
\code{\link[phyloseq]{otu_table}}
}
