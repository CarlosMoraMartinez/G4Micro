% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotRelativeAbnBarsGenus.R
\name{plotRelativeAbnBarsGenus}
\alias{plotRelativeAbnBarsGenus}
\title{Barplot of Relative Abundance by Genus}
\usage{
plotRelativeAbnBarsGenus(
  phobj,
  variable = "Condition",
  topn = 15,
  outname = "phylumBarplot.pdf",
  height = 8,
  width = 12,
  ocluster = T,
  oldlevs = c("Control", "Depression"),
  wespalette = "Darjeeling2"
)
}
\arguments{
\item{phobj}{A \code{phyloseq} object containing microbiome data.}

\item{variable}{A character string indicating the name of the variable in sample metadata
used for grouping samples, Default: 'Condition'.}

\item{topn}{Integer; number of top genera to include in the barplot based on total relative prevalence, Default: 15.}

\item{outname}{Output filename for the plot in PDF format, Default: 'phylumBarplot.pdf'.}

\item{height}{Height of the saved PDF plot in inches, Default: 8.}

\item{width}{Width of the saved PDF plot in inches, Default: 12.}

\item{ocluster}{Logical; whether to cluster samples by genus abundance profile, Default: TRUE.}

\item{oldlevs}{A character vector indicating the original levels of the grouping variable. Must be of length 2, Default: c("Control", "Depression").}

\item{wespalette}{Character string specifying a palette name from \code{wesanderson}, used for coloring the genera, Default: 'Darjeeling2'.}
}
\value{
A \code{ggplot} object representing the stacked barplot of genus-level relative abundances.
}
\description{
Generates stacked barplots of genus-level relative abundances from a phyloseq object,
stratified by a sample metadata variable. The plot includes only the top N most prevalent genera.
}
\details{
This function identifies the top \code{topn} most prevalent genera across all samples,
computes their relative abundances per sample, and visualizes them in a stacked barplot.
The samples can be ordered by hierarchical clustering or by abundance of the most prevalent genus.
The palette is generated using \code{wesanderson::wes_palette} and must support enough colors for \code{topn} genera.
}
\examples{
\dontrun{
if(interactive()){
 plotRelativeAbnBarsGenus(phobj, variable = "Group", topn = 10)
 }
}
}
\seealso{
\code{\link[dplyr]{arrange}}, \code{\link[dplyr]{summarise}}, \code{\link[dplyr]{mutate}}, \code{\link[dplyr]{summarise_all}}, \code{\link[dplyr]{mutate_all}}
\code{\link[tidyr]{gather}}
}
